import { APP_INITIALIZER, Injector } from '@angular/core';
import { combineLatest } from 'rxjs';
import { RoutesService } from '@abp/ng.core';
import { SETTING_MANAGEMENT_HAS_SETTING } from './route.provider';
import { SETTING_MANAGEMENT_ROUTE_VISIBILITY } from './features.token';
export const SETTING_MANAGEMENT_VISIBLE_PROVIDERS = [
    {
        provide: APP_INITIALIZER,
        useFactory: setSettingManagementVisibility,
        deps: [Injector],
        multi: true,
    },
];
export function setSettingManagementVisibility(injector) {
    return () => {
        const settingManagementHasSetting$ = injector.get(SETTING_MANAGEMENT_HAS_SETTING);
        const isSettingManagementFeatureEnable$ = injector.get(SETTING_MANAGEMENT_ROUTE_VISIBILITY);
        const routes = injector.get(RoutesService);
        combineLatest([settingManagementHasSetting$, isSettingManagementFeatureEnable$]).subscribe(([settingManagementHasSetting, isSettingManagementFeatureEnable]) => {
            routes.patch("AbpSettingManagement::Settings" /* Settings */, {
                invisible: !(settingManagementHasSetting && isSettingManagementFeatureEnable),
            });
        });
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidmlzaWJsZS5wcm92aWRlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uLy4uL3BhY2thZ2VzL3NldHRpbmctbWFuYWdlbWVudC9jb25maWcvc3JjL3Byb3ZpZGVycy92aXNpYmxlLnByb3ZpZGVyLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sRUFBRSxlQUFlLEVBQUUsUUFBUSxFQUFFLE1BQU0sZUFBZSxDQUFDO0FBQzFELE9BQU8sRUFBRSxhQUFhLEVBQUUsTUFBTSxNQUFNLENBQUM7QUFDckMsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLGNBQWMsQ0FBQztBQUM3QyxPQUFPLEVBQUUsOEJBQThCLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUNsRSxPQUFPLEVBQUUsbUNBQW1DLEVBQUUsTUFBTSxrQkFBa0IsQ0FBQztBQUd2RSxNQUFNLENBQUMsTUFBTSxvQ0FBb0MsR0FBRztJQUNsRDtRQUNFLE9BQU8sRUFBRSxlQUFlO1FBQ3hCLFVBQVUsRUFBRSw4QkFBOEI7UUFDMUMsSUFBSSxFQUFFLENBQUMsUUFBUSxDQUFDO1FBQ2hCLEtBQUssRUFBRSxJQUFJO0tBQ1o7Q0FDRixDQUFDO0FBRUYsTUFBTSxVQUFVLDhCQUE4QixDQUFDLFFBQWtCO0lBQy9ELE9BQU8sR0FBRyxFQUFFO1FBQ1YsTUFBTSw0QkFBNEIsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLDhCQUE4QixDQUFDLENBQUM7UUFDbEYsTUFBTSxpQ0FBaUMsR0FBRyxRQUFRLENBQUMsR0FBRyxDQUFDLG1DQUFtQyxDQUFDLENBQUM7UUFDNUYsTUFBTSxNQUFNLEdBQUcsUUFBUSxDQUFDLEdBQUcsQ0FBQyxhQUFhLENBQUMsQ0FBQztRQUMzQyxhQUFhLENBQUMsQ0FBQyw0QkFBNEIsRUFBRSxpQ0FBaUMsQ0FBQyxDQUFDLENBQUMsU0FBUyxDQUN4RixDQUFDLENBQUMsMkJBQTJCLEVBQUUsZ0NBQWdDLENBQUMsRUFBRSxFQUFFO1lBQ2xFLE1BQU0sQ0FBQyxLQUFLLGtEQUF3QztnQkFDbEQsU0FBUyxFQUFFLENBQUMsQ0FBQywyQkFBMkIsSUFBSSxnQ0FBZ0MsQ0FBQzthQUM5RSxDQUFDLENBQUM7UUFDTCxDQUFDLENBQ0YsQ0FBQztJQUNKLENBQUMsQ0FBQztBQUNKLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBBUFBfSU5JVElBTElaRVIsIEluamVjdG9yIH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XHJcbmltcG9ydCB7IGNvbWJpbmVMYXRlc3QgfSBmcm9tICdyeGpzJztcclxuaW1wb3J0IHsgUm91dGVzU2VydmljZSB9IGZyb20gJ0BhYnAvbmcuY29yZSc7XHJcbmltcG9ydCB7IFNFVFRJTkdfTUFOQUdFTUVOVF9IQVNfU0VUVElORyB9IGZyb20gJy4vcm91dGUucHJvdmlkZXInO1xyXG5pbXBvcnQgeyBTRVRUSU5HX01BTkFHRU1FTlRfUk9VVEVfVklTSUJJTElUWSB9IGZyb20gJy4vZmVhdHVyZXMudG9rZW4nO1xyXG5pbXBvcnQgeyBlU2V0dGluZ01hbmFnZW1lbnRSb3V0ZU5hbWVzIH0gZnJvbSAnLi4vZW51bXMnO1xyXG5cclxuZXhwb3J0IGNvbnN0IFNFVFRJTkdfTUFOQUdFTUVOVF9WSVNJQkxFX1BST1ZJREVSUyA9IFtcclxuICB7XHJcbiAgICBwcm92aWRlOiBBUFBfSU5JVElBTElaRVIsXHJcbiAgICB1c2VGYWN0b3J5OiBzZXRTZXR0aW5nTWFuYWdlbWVudFZpc2liaWxpdHksXHJcbiAgICBkZXBzOiBbSW5qZWN0b3JdLFxyXG4gICAgbXVsdGk6IHRydWUsXHJcbiAgfSxcclxuXTtcclxuXHJcbmV4cG9ydCBmdW5jdGlvbiBzZXRTZXR0aW5nTWFuYWdlbWVudFZpc2liaWxpdHkoaW5qZWN0b3I6IEluamVjdG9yKSB7XHJcbiAgcmV0dXJuICgpID0+IHtcclxuICAgIGNvbnN0IHNldHRpbmdNYW5hZ2VtZW50SGFzU2V0dGluZyQgPSBpbmplY3Rvci5nZXQoU0VUVElOR19NQU5BR0VNRU5UX0hBU19TRVRUSU5HKTtcclxuICAgIGNvbnN0IGlzU2V0dGluZ01hbmFnZW1lbnRGZWF0dXJlRW5hYmxlJCA9IGluamVjdG9yLmdldChTRVRUSU5HX01BTkFHRU1FTlRfUk9VVEVfVklTSUJJTElUWSk7XHJcbiAgICBjb25zdCByb3V0ZXMgPSBpbmplY3Rvci5nZXQoUm91dGVzU2VydmljZSk7XHJcbiAgICBjb21iaW5lTGF0ZXN0KFtzZXR0aW5nTWFuYWdlbWVudEhhc1NldHRpbmckLCBpc1NldHRpbmdNYW5hZ2VtZW50RmVhdHVyZUVuYWJsZSRdKS5zdWJzY3JpYmUoXHJcbiAgICAgIChbc2V0dGluZ01hbmFnZW1lbnRIYXNTZXR0aW5nLCBpc1NldHRpbmdNYW5hZ2VtZW50RmVhdHVyZUVuYWJsZV0pID0+IHtcclxuICAgICAgICByb3V0ZXMucGF0Y2goZVNldHRpbmdNYW5hZ2VtZW50Um91dGVOYW1lcy5TZXR0aW5ncywge1xyXG4gICAgICAgICAgaW52aXNpYmxlOiAhKHNldHRpbmdNYW5hZ2VtZW50SGFzU2V0dGluZyAmJiBpc1NldHRpbmdNYW5hZ2VtZW50RmVhdHVyZUVuYWJsZSksXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH0sXHJcbiAgICApO1xyXG4gIH07XHJcbn1cclxuIl19